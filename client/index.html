<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <script>
      // Disable Vite HMR completely in deployment environment
      if (window.location.hostname.includes('replit.dev') || window.location.hostname.includes('.replit.app')) {
        // Completely disable HMR by overriding import.meta.hot
        if (typeof window !== 'undefined') {
          window.__vite_plugin_react_preamble_installed__ = true;
        }
        
        // Block all HMR WebSocket connections
        const originalWebSocket = window.WebSocket;
        window.WebSocket = function(url, protocols) {
          const urlStr = url.toString();
          
          // Block any HMR-related WebSocket connections
          if (urlStr.includes('localhost') || urlStr.includes('vite') || urlStr.includes('hmr') || urlStr.includes('token=')) {
            console.log('ðŸš« HMR disabled for deployment - blocking WebSocket:', urlStr);
            // Return mock WebSocket that appears closed
            const mockSocket = {
              close() {},
              send() {},
              addEventListener() {},
              removeEventListener() {},
              readyState: 3,
              CONNECTING: 0,
              OPEN: 1,
              CLOSING: 2,
              CLOSED: 3
            };
            // Simulate immediate close
            setTimeout(() => {
              if (mockSocket.onclose) mockSocket.onclose();
            }, 0);
            return mockSocket;
          }
          
          return new originalWebSocket(url, protocols);
        };
        
        Object.setPrototypeOf(window.WebSocket, originalWebSocket);
        Object.defineProperty(window.WebSocket, 'prototype', { 
          value: originalWebSocket.prototype 
        });
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>